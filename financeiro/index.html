<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gestor Financeiro ‚Äî CSV (GitHub Pages)</title>
  <link rel="stylesheet" href="app.css" />
</head>
<body>

  <!-- LOGIN -->
  <div id="auth">
    <div class="box">
      <h2>Entrar</h2>
      <form id="loginForm" class="row">
        <div class="field">
          <label for="loginUser">Usu√°rio</label>
          <input id="loginUser" name="loginUser" autocomplete="username" required/>
        </div>
        <div class="field">
          <label for="loginPass">Senha</label>
          <input id="loginPass" name="loginPass" type="password" autocomplete="current-password" required/>
        </div>
        <div class="field">
          <label><input type="checkbox" id="loginCriar"/> Criar usu√°rio se n√£o existir</label>
        </div>
        <div class="actions">
          <button class="btn primary" id="btnLogin" type="submit">Entrar</button>
        </div>
      </form>
      <small>
        Vers√£o 100% est√°tica para rodar no <strong>GitHub Pages</strong>.<br/>
        O CSV √© salvo no seu computador usando a <strong>File System Access API</strong>.<br/>
        <em>Use Chrome/Edge (desktop)</em>. No 1¬∫ uso ser√° pedido para escolher/criar o arquivo <code>&lt;usuario&gt;.csv</code>.
      </small>
    </div>
  </div>

  <div class="container hidden" id="app">
    <header>
      <h1>üí∞ Gestor Financeiro ‚Äî Contas a Pagar/Receber</h1>
      <div class="actions">
        <button class="btn" id="btnSalvarCSV" type="button">Salvar CSV</button>
        <button class="btn primary" id="btnNovo" type="button">+ Nova Transa√ß√£o</button>
      </div>
    </header>

    <div class="grid cols-3">
      <div class="card"><div class="body">
        <div class="kpi">
          <div><div class="muted">Saldo projetado (30 dias)</div><strong id="kpiSaldo">R$ 0,00</strong></div>
          <span class="pill" id="kpiSaldoTag">OK</span>
        </div>
      </div></div>
      <div class="card"><div class="body">
        <div class="kpi">
          <div><div class="muted">A pagar (30 dias)</div><strong class="danger" id="kpiPagar">R$ 0,00</strong></div>
          <span class="pill warn">Aten√ß√£o</span>
        </div>
      </div></div>
      <div class="card"><div class="body">
        <div class="kpi">
          <div><div class="muted">A receber (30 dias)</div><strong class="success" id="kpiReceber">R$ 0,00</strong></div>
          <span class="pill ok">Entrada</span>
        </div>
      </div></div>
    </div>

    <div class="grid cols-2" style="margin-top:16px">
      <div class="card"><div class="body">
        <h2>Transa√ß√µes</h2>
        <div class="row" style="margin-bottom:8px">
          <div class="field"><select id="filtroMes"></select></div>
          <div class="field"><select id="filtroTipo"><option value="">Todos os tipos</option><option value="PAGAR">A Pagar</option><option value="RECEBER">A Receber</option></select></div>
          <div class="field" style="grid-column: span 2"><input id="busca" placeholder="Buscar descri√ß√£o/categoria"/></div>
          <div class="field"><select id="filtroStatus"><option value="">Todos status</option><option>pendente</option><option>concluida</option></select></div>
        </div>
        <div style="max-height:360px; overflow:auto">
          <table>
            <thead><tr><th>Data</th><th>Tipo</th><th>Descri√ß√£o</th><th>Categoria</th><th class="right">Valor</th><th>Status</th><th>Recorr√™ncia</th><th></th></tr></thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>
      </div></div>

      <div class="card"><div class="body">
        <h2>Cadastro / Edi√ß√£o</h2>
        <div class="row">
          <div class="field"><label>Tipo</label><select id="tipo"><option value="PAGAR">A Pagar</option><option value="RECEBER">A Receber</option></select></div>
          <div class="field"><label>Data (venc./prev.)</label><input type="date" id="data" /></div>
          <div class="field"><label>Valor (R$)</label><input type="number" id="valor" step="0.01" min="0" placeholder="0,00" /></div>
          <div class="field"><label>Status</label><select id="status"><option>pendente</option><option>concluida</option></select></div>
          <div class="field"><label>Recorr√™ncia</label><select id="recorrencia"><option value="nenhuma">Nenhuma</option><option value="mensal">Mensal</option></select></div>
          <div class="field"><label>Parcelas (se houver)</label><input type="number" id="parcelas" min="1" value="1" /></div>
        </div>
        <div class="row" style="margin-top:10px">
          <div class="field" style="grid-column: span 3"><label>Descri√ß√£o</label><input id="descricao" placeholder="Ex.: Aluguel, Sal√°rio, Cart√£o"/></div>
          <div class="field" style="grid-column: span 3"><label>Categoria</label><input id="categoria" placeholder="Ex.: Moradia, Alimenta√ß√£o, Vendas"/></div>
        </div>
        <div class="row" style="margin-top:12px">
          <div class="field"><button class="btn primary" id="btnSalvar" type="button">Salvar</button></div>
          <div class="field"><button class="btn" id="btnLimpar" type="button">Limpar</button></div>
          <div class="field"><span class="muted" id="editHint"></span></div>
        </div>
        <div class="divider"></div>
        <div class="row">
          <div class="field"><label>Saldo inicial (R$)</label><input type="number" id="saldoInicial" step="0.01" placeholder="0,00" /></div>
          <div class="field"><label>&nbsp;</label><button class="btn" id="btnAplicarSaldo" type="button">Aplicar saldo</button></div>
        </div>
      </div></div>
    </div>

    <div class="grid cols-2" style="margin-top:16px">
      <div class="card"><div class="body"><h2>Proje√ß√£o 12 meses</h2><canvas id="chartFluxo" height="220"></canvas></div></div>
      <div class="card"><div class="body"><h2>Distribui√ß√£o por categoria</h2><canvas id="chartPizza" height="220"></canvas></div></div>
    </div>

    <div class="footer">
      <strong>GitHub Pages:</strong> app est√°tico; os dados ficam no seu CSV local via File System Access.<br/>
      <em>Sem backend/servidor ‚Äî nada sai do seu navegador.</em>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="app.js"></script>
</body>
</html>
